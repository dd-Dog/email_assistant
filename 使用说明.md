# 邮件助手 V3.0 - 使用说明

## 📋 快速开始

### 1. 配置邮箱信息

编辑 `config.json`：

```json
{
  "email_account": {
    "username": "your@company.com",     // 您的邮箱
    "password": "your_password"         // 密码或授权码
  },
  "target_emails": [                    // 接收报告的邮箱（可多个）
    "your@qq.com",
    "your@company.com"
  ],
  "leaders": {                          // 领导配置
    "boss@company.com": "张总"
  },
  "project_managers": {                 // 项目经理配置
    "pm@company.com": "李经理"
  },
  "employees": {                        // 员工配置
    "emp@company.com": "王同事"
  }
}
```

### 2. 运行方式

**立即运行一次：**
```bash
python main.py
```
或双击 `run_once.bat`

**启动定时任务：**
```bash
python scheduler.py
```
或双击 `run_scheduler.bat`

### 3. 查看报告

**主要方式：** 打开 `reports/` 文件夹，查看最新的报告文件

**备用方式：** 如果邮件收到了，直接查看邮件

## 📊 报告内容

### 格式说明

```
======================================================================
📧 邮件助手每日报告 V3.0
======================================================================
生成时间: 2025-11-11 13:45:55 (ID:20251111134555)
邮件总数: 18封 | 领导: 1 | 项目经理: 3 | 员工: 14

======================================================================
🚨 连续3天未解决的问题（重点关注）
======================================================================
[问题1] 项目延期问题
  发件人: 张三(zhang@company.com) | 连续3天 | 共5封
  ...

======================================================================
👔 领导邮件汇总 (2封)
======================================================================
【张总】(boss@company.com) 2封
  2025-11-11:
    09:30 项目进度确认
      请尽快完成...
  2025-11-10:
    ...

======================================================================
📋 项目经理邮件汇总 (8封)
======================================================================
【李经理】(pm@company.com) 3封
  ...

======================================================================
👥 员工邮件汇总 (8封)
======================================================================
【王同事】(emp@company.com) 2封
  ...
```

## ⚙️ 配置说明

### 人员分类

- **leaders（领导）** - 高层领导，邮件完整展示，最重要
- **project_managers（项目经理）** - 项目管理人员，邮件完整展示
- **employees（员工）** - 普通员工，会检测重复问题

### 检测规则

- 只对**员工邮件**检测重复问题
- 连续3天出现相似内容 → 标记为重复问题
- 重复问题单独显示在最前面

### 时间设置

```json
{
  "schedule_time": "09:00",      // 每天运行时间
  "days_to_check": 3,            // 检查最近3天
  "repeat_issue_days": 3         // 连续3天算重复
}
```

## 🔧 工具脚本

| 脚本 | 功能 | 使用场景 |
|------|------|---------|
| `run_once.bat` | 立即运行一次 | 手动检查 |
| `run_scheduler.bat` | 启动定时任务 | 日常使用 |
| `debug_report.bat` | 调试工具 | 查看报告内容 |
| `test_connection.bat` | 连接测试 | 排查连接问题 |
| `test_send_email.bat` | 发送测试 | 排查邮件问题 |
| `install.bat` | 安装依赖 | 首次安装 |

## 📁 文件说明

### 核心代码
- `main.py` - 主程序
- `email_client.py` - 邮件客户端
- `email_analyzer.py` - 邮件分析器
- `report_generator_text.py` - 报告生成器
- `content_cleaner.py` - 内容清理器
- `scheduler.py` - 定时任务

### 配置文件
- `config.json` - 您的配置（不提交）
- `config.example.json` - 配置模板

### 输出文件
- `reports/` - 生成的报告文件
- `*.log` - 运行日志

## 💡 使用建议

### 日常工作流

1. **自动运行**：每天早上9点自动运行
2. **查看报告**：10点来上班，打开 `reports/` 文件夹查看最新报告
3. **关注重点**：先看重复问题，再看领导和项目经理的邮件
4. **快速浏览**：员工邮件可以快速浏览

### 人员配置建议

- **领导**：老板、副总等高层（2-5人）
- **项目经理**：各项目负责人（5-10人）
- **员工**：普通同事（10-20人）

不要配置太多人，会导致信息过载。

## 🚨 重要提示

### 邮件送达问题

由于邮件系统的反垃圾机制，邮件可能收不到：
- **主要方式**：查看本地 `reports/` 文件夹 ⭐
- **备用方式**：邮件通知（如果收到）

### 如何提高送达率

1. **避免频繁发送** - 不要短时间内多次运行
2. **定时自动运行** - 每天固定时间运行一次
3. **设置白名单** - 将发件邮箱加入白名单
4. **检查垃圾箱** - 初期可能在垃圾邮件

### 安全注意

- `config.json` 包含密码，请妥善保管
- 已添加到 `.gitignore`，不会提交到Git
- 建议使用授权码而非登录密码

## 🎯 效果

- ⚡ 处理速度：约30-60秒（取决于邮件数量）
- 📧 邮件范围：最近3天的重点邮件
- 📄 报告大小：约2-5KB的纯文本文件
- 🎯 准确性：自动清理无关内容，只看重点

---

**祝使用愉快！让邮件助手帮您减少工作量！** 📧✨

