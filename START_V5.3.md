# V5.3 快速开始指南

## 🚀 3步开始使用V5.3

---

## 第一步：生成人员信息表

**您有两个选择：**

### 选择A：从现有config.json迁移（推荐！）⭐

```bash
python migrate_to_excel.py
```

**输出：**
```
找到 28 个人员
[OK] 成功导出到: persons/人员信息表_迁移.xlsx
```

**然后：**
```bash
# 重命名为V5.3版本
move persons\人员信息表_迁移.xlsx persons\人员信息表_V5.3.xlsx
```

**优势：** 已有28个人的基本信息，只需补充组织关系！

---

### 选择B：从空白模板开始

```bash
python create_person_excel_v5.3.py
```

**输出：**
```
[OK] Excel模板创建成功：persons/人员信息表_V5.3.xlsx
```

**优势：** 有完整示例数据和4个说明工作表！

---

## 第二步：补充组织关系（重要！）

**打开Excel：**
```bash
start persons\人员信息表_V5.3.xlsx
```

**需要填写的组织关系字段：**

| 字段 | 谁需要填 | 填什么 | 示例 |
|------|---------|--------|------|
| 所属部门 | 员工/部门领导/PM | 部门名称 | 研发部 |
| 直属领导 | 员工/部门领导/PM | 上级姓名 | 陈琦 |
| 负责部门 | 高层领导 | 部门列表（逗号分隔） | 技术部,市场部 |
| 负责客户 | PM | 客户姓名 | 肖正伟 |

**示例：**

```
邢鹏鹏（员工）
├─ 人员类型: employee
├─ 所属部门: 研发部
└─ 直属领导: 陈琦

陈琦（部门领导）
├─ 人员类型: department_leader
├─ 所属部门: 研发部
└─ 直属领导: 史国鹏

张盛世（PM）
├─ 人员类型: pm
├─ 所属部门: 技术部
├─ 直属领导: 徐智慧
└─ 负责客户: 肖正伟
```

**提示：** Excel中有"组织架构示例"工作表可参考！

---

## 第三步：测试

**测试组织关系：**
```bash
python test_org_relationship.py
```

**应该看到：**
```
[测试1] 组织架构摘要
总人数: 28
人员类型分布: top_leader, department_leader, pm, employee...

[测试2] 查找直属领导
邢鹏鹏 → 直属领导: 陈琦 (研发部经理)

[测试3] 查找下属列表
陈琦 的下属 (3人):
  - 邢鹏鹏 (高级工程师)
  - 李越征 (工程师)
  - 孙希鑫 (驱动工程师)

[测试4] 责任链查询
邢鹏鹏的责任链:
└─ 邢鹏鹏 (高级工程师) [员工]
  └─ 陈琦 (研发部经理) [部门领导]
    └─ 史国鹏 (副总) [高层领导]

[测试5] PM-客户关系
项目经理 张盛世:
  → 负责客户: 肖正伟 (深圳九胜科技)
```

**如果看到以上输出，说明配置成功！** ✅

---

## 🎯 快速命令

### 推荐流程（现有用户）

```bash
# 1. 迁移配置
python migrate_to_excel.py

# 2. 重命名文件
move persons\人员信息表_迁移.xlsx persons\人员信息表_V5.3.xlsx

# 3. 打开Excel补充组织关系
start persons\人员信息表_V5.3.xlsx

# 4. 测试组织关系
python test_org_relationship.py

# 5. 正常运行
python main_v4.py
```

---

## 📋 核心文件说明

### 使用哪个Excel？

**V5.3版本：** `persons/人员信息表_V5.3.xlsx` ⭐ **推荐**

**包含：**
- ✅ 18个字段（比旧版多4个组织关系字段）
- ✅ 4个工作表（数据、字段说明、类型说明、组织架构示例）
- ✅ 示例数据（完整组织架构）

**其他版本：**
- `人员信息表.xlsx` - V5.2基础版（14字段，无组织关系）
- `人员信息表_迁移.xlsx` - 从config.json导出的（需要补充）
- `人员信息表_模板.xlsx` - 空白模板

---

## 🔧 常见问题

### Q1: 我应该用哪个Excel文件？

**A:** 使用 **`人员信息表_V5.3.xlsx`** ⭐

```bash
# 如果还没有，运行：
python create_person_excel_v5.3.py

# 或从config.json迁移：
python migrate_to_excel.py
move persons\人员信息表_迁移.xlsx persons\人员信息表_V5.3.xlsx
```

### Q2: 必须填写所有组织关系字段吗？

**A:** 不是必须的，但强烈建议填写！

**最小配置：**
- 必填：姓名、邮箱、人员类型

**推荐配置：**
- 员工：+ 所属部门、直属领导
- PM：+ 负责客户
- 高层：+ 负责部门

**完整配置：**
- 所有字段都填（最佳效果）

### Q3: 人员类型代码是什么？

**A:** V5.3支持6种类型：

| 类型代码 | 中文 | 用途 |
|---------|------|------|
| `top_leader` | 高层领导 | 公司高层 |
| `department_leader` | 部门领导 | 部门经理 |
| `pm` | 项目经理 | PM |
| `employee` | 员工 | 普通员工 |
| `customer` | 客户 | 客户 |
| `supplier` | 供应商 | 供应商 |

**Excel中有"人员类型说明"工作表详细说明！**

### Q4: 直属领导填邮箱还是姓名？

**A:** **填写姓名！**

```
✅ 正确: 陈琦
❌ 错误: chenqi@flyscale.cn
```

程序会自动根据姓名查找邮箱！

### Q5: 测试失败怎么办？

**A:** 检查以下几点：

1. Excel文件名是否正确
2. 人员类型代码是否正确
3. 直属领导姓名是否与人员表中的姓名完全一致
4. Excel文件是否已关闭（打开时无法读取）

---

## ✅ 测试检查清单

执行测试前请确认：

- [ ] Excel文件已创建（V5.3版本）
- [ ] Excel文件已关闭（不能打开着测试）
- [ ] 人员类型使用新代码（top_leader等）
- [ ] 组织关系字段已填写（至少部分）
- [ ] 姓名拼写准确（用于关系匹配）

---

## 🎯 立即开始

**最快速的方式（5分钟）：**

```bash
# 1. 迁移现有配置
python migrate_to_excel.py

# 2. 使用迁移的文件
move persons\人员信息表_迁移.xlsx persons\人员信息表_V5.3.xlsx

# 3. 测试（先用基本信息测试）
python test_org_relationship.py

# 4. （可选）打开Excel补充组织关系
start persons\人员信息表_V5.3.xlsx

# 5. 再次测试
python test_org_relationship.py
```

---

**准备好了吗？开始测试吧！** 🚀

